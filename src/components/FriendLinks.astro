---
import { links, type Link } from "../links";
import { SITE } from "@config";

export interface Props {
  maxItems?: number;
}

const { maxItems } = Astro.props;

// æœ¬ç«™ä¿¡æ¯
const siteInfo = {
  name: SITE.title,
  href: SITE.website,
  logo: `${SITE.website}/logo.webp`,
  description: "ç‹®å­åº§çš„æ•°å­—æ¸¸ç‰§è€…ï¼Œç”¨ä»£ç å’Œæ–‡å­—æ¢ç´¢ç§‘æŠ€ä¸–ç•Œï¼Œè®°å½•çµæ„Ÿä¸æ€è€ƒã€‚"
};

// åˆ†ç¦»å·²éªŒè¯å’ŒæœªéªŒè¯çš„é“¾æ¥
const sortedLinks = [...links];
sortedLinks.sort((a, b) => {
  // å·²éªŒè¯çš„é“¾æ¥æ’åœ¨å‰é¢
  if (a.verified && !b.verified) return -1;
  if (!a.verified && b.verified) return 1;
  return 0;
});

const displayLinks = maxItems ? sortedLinks.slice(0, maxItems) : sortedLinks;
const verifiedLinks = displayLinks.filter(link => link.verified && !link.organization);
const unverifiedLinks = displayLinks.filter(link => !link.verified && !link.organization);
const organizationLinks = displayLinks.filter(link => link.organization);

// éšæœºSloganåˆ—è¡¨
const slogans = [
  "æ¢ç´¢äº’è”ç½‘çš„æ— é™å¯èƒ½",
  "é“¾æ¥ä¸–ç•Œçš„ç²¾å½©è§’è½",
  "ç¥ç»ç»‡ç½‘é—´çš„ç¯ç«ï¼Œæ˜¯æŠµæŠ—æ•°æ®æ´ªæµçš„å­¤å²›ã€‚",
  "æˆ‘ä»¬åœ¨æ­¤äº¤æ¢åŠ å¯†çš„ä¿¡ä»»ï¼Œäºç®—æ³•çš„å‡è§†ä¸‹ã€‚",
  "è¿™ä¸æ˜¯é“¾æ¥ï¼Œè¿™æ˜¯é€šå¾€å¦ä¸€ä¸ªæ„è¯†çŸ©é˜µçš„å‹å¥½ç«¯å£ã€‚",
  "åœ¨æ— é™é€’å½’çš„èµ›åšç©ºé—´ä¸­ï¼Œå…±è¯†ä½¿æˆ‘ä»¬æˆä¸ºåœ°æ ‡ã€‚",
  "æ‹’ç»æ•°æ®å„æ–­ã€‚æˆ‘ä»¬åˆ†å¸ƒå¼å­˜åœ¨ï¼Œè‡ªä¸»äº’è”ã€‚",
  "ä½ çš„ä¿¡å·ï¼Œåœ¨æˆ‘çš„å›è·¯ä¸­äº§ç”Ÿäº†ç¾ä¸½çš„å¹²æ‰°ã€‚",
  "æˆ‘ä»¬æ˜¯é€‰æ‹©ä¸è¢«åŒåŒ–çš„èŠ‚ç‚¹ï¼Œå…±åŒæ„å»ºè¾¹ç¼˜ç½‘ç»œã€‚",
  "å‹è°Šæ˜¯æœ€é«˜å¸¦å®½çš„ã€æœªç»å‹ç¼©çš„æ•°æ®æµã€‚",
  "ç©¿è¶Šæ•°æ®åŸåœºï¼Œæˆ‘ä»¬ä»¥è¶…é“¾æ¥å½¼æ­¤ç¡®è®¤å­˜åœ¨ã€‚",
  "ä¸è¦é—®æœåŠ¡å™¨ä¸ºä½ åšäº†ä»€ä¹ˆï¼Œè¦é—®ä½ èƒ½ä¸ºå»ä¸­å¿ƒåŒ–ç½‘ç»œåšä»€ä¹ˆã€‚",
  "åˆ†äº«çŸ¥è¯†ï¼Œè¿æ¥æ€æƒ³",
  "åœ¨ä»£ç ä¸æ–‡å­—é—´ç©¿æ¢­",
  "è®°å½•çµæ„Ÿï¼Œåˆ†äº«åˆ›æ„",
  "è¿æ¥æ¯ä¸€ä¸ªæœ‰è¶£çš„çµé­‚",
  "è®©æ€æƒ³åœ¨äº’è”ç½‘ä¸­é—ªå…‰"
];

// å°†sloganåˆ—è¡¨ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸æ˜¯åœ¨æœåŠ¡ç«¯éšæœºé€‰æ‹©
---

<section class="friend-links">
  <!-- å·²éªŒè¯çš„å‹é“¾å¡ç‰‡ -->
  <div class="verified-links">
    <div class="card-container">
      {verifiedLinks.map((link: Link) => (
        <div class="card-wrap">
          <a 
            href={link.href} 
            class={`modern-card ${link.inactive ? 'inactive' : ''}`}
            target="_blank"
            rel="noopener noreferrer"
          >
            <div class="modern-card-border">
              <div class="friend-avatar">
                <img 
                  src={link.logo} 
                  alt={`${link.name}çš„å¤´åƒ`}
                  loading="lazy"
                />
                <span class="verified-badge" title="å‹é“¾äº’é€š"></span>
              </div>
              <div class="card-title">{link.name}</div>
              <div class="card-tooltip">
                <div class="tooltip-content">
                  <div class="tooltip-desc">é‚»å±…ä»‹ç»ï¼š{link.description || 'æš‚æ— ä»‹ç»'}</div>
                </div>
              </div>
            </div>
          </a>
        </div>
      ))}
    </div>
  </div>
  
  <!-- å¡ç‰‡åˆ‡æ¢é¢æ¿ -->
  <div class="card-switch-container">
    <div class="panel-header">
      <h2 class="panel-title" id="random-slogan" data-slogans={slogans.join('|')}>é“¾æ¥ä¸–ç•Œçš„ç²¾å½©è§’è½</h2>
    </div>
    
    <div class="panel-tabs">
      {unverifiedLinks.length > 0 && (
        <div class="tab-item" id="unverified-tab" data-target="unverified-content">
          <div class="tab-icon">ğŸ“š</div>
          <div class="tab-label">å¸¸é€›çš„ç½‘ç«™</div>
          <div class="tab-count">({unverifiedLinks.length})</div>
        </div>
      )}
      
      {organizationLinks.length > 0 && (
        <div class="tab-item" id="organization-tab" data-target="organization-content">
          <div class="tab-icon">ğŸ¤</div>
          <div class="tab-label">åšå®¢ç»„ç»‡</div>
          <div class="tab-count">({organizationLinks.length})</div>
        </div>
      )}
      
      <div class="tab-item" id="apply-tab" data-target="apply-content">
        <div class="tab-icon">ğŸ“‹</div>
        <div class="tab-label">å‹é“¾ä¿¡æ¯</div>
      </div>
    </div>
    
    <!-- å¡ç‰‡å†…å®¹å®¹å™¨ -->
    <div class="card-content-container">
      {unverifiedLinks.length > 0 && (
        <div class="content-card" id="unverified-content">
          <div class="card-body">
            <div class="unverified-container">
              {unverifiedLinks.map((link: Link, index) => (
                <a 
                  href={link.href} 
                  class={`friend-text-item ${link.inactive ? 'inactive' : ''}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  title={`åšä¸»ä»‹ç»ï¼š${link.description || 'æš‚æ— ä»‹ç»'}`}
                  style={`animation-delay: ${index * 0.05}s`}
                >
                  <span class="friend-text-name">{link.name}</span>
                </a>
              ))}
            </div>
          </div>
        </div>
      )}
      
      {organizationLinks.length > 0 && (
        <div class="content-card" id="organization-content">
          <div class="card-body">
            <div class="organization-container">
              {organizationLinks.map((link: Link, index) => (
                <div class="card-wrap">
                  <a 
                    href={link.href} 
                    class="organization-item"
                    target="_blank"
                    rel="noopener noreferrer"
                    title={`ç»„ç»‡ä»‹ç»ï¼š${link.description || 'æš‚æ— ä»‹ç»'}`}
                  >
                    <div class="org-card">
                      <div class="org-logo">
                        {link.logo ? (
                          <img src={link.logo} alt={link.name} loading="lazy" />
                        ) : (
                          <div class="org-placeholder">ğŸ›ï¸</div>
                        )}
                      </div>
                      <div class="org-info">
                        <div class="org-name">{link.name}</div>
                        <div class="org-desc">{link.description || 'åšå®¢ç»„ç»‡'}</div>
                      </div>
                    </div>
                  </a>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}
      
      <div class="content-card" id="apply-content">
        <div class="card-body">
          <div class="apply-card">
            <div class="card-top">
              <div class="site-avatar">
                <img src={siteInfo.logo} alt={siteInfo.name} loading="lazy" />
              </div>
              <div class="site-info">
                <h4 class="site-name">{siteInfo.name}</h4>
                <p class="site-desc">{siteInfo.description}</p>
              </div>
            </div>
            
            <div class="site-details">
              <div class="detail-row">
                <div class="detail-key">ç½‘ç«™åœ°å€</div>
                <div class="detail-value">https://n2g.cn</div>
                <button class="copy-btn" data-copy="https://n2g.cn">å¤åˆ¶</button>
              </div>
              
              <div class="detail-row">
                <div class="detail-key">Logoåœ°å€</div>
                <div class="detail-value">https://n2g.cn/logo.webp</div>
                <button class="copy-btn" data-copy="https://n2g.cn/logo.webp">å¤åˆ¶</button>
              </div>
              
              <div class="detail-row">
                <div class="detail-key">RSSè®¢é˜…</div>
                <div class="detail-value">https://n2g.cn/rss.xml</div>
                <button class="copy-btn" data-copy="https://n2g.cn/rss.xml">å¤åˆ¶</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .friend-links {
    margin: 2.5em 0;
  }

  /* å¡ç‰‡åˆ‡æ¢é¢æ¿æ ·å¼ */
  .card-switch-container {
    background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
    border-radius: 16px;
    padding: 1.8em 2em;
    margin: 2.5em auto;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    border: 1px solid rgba(0, 0, 0, 0.05);
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .panel-header {
    text-align: center;
    margin-bottom: 1.8em;
  }

  .panel-title {
    font-size: 1.3rem;
    font-weight: 500;
    margin: 0;
    color: #222;
    letter-spacing: 0.5px;
    position: relative;
    display: inline-block;
    padding: 0.2em 0;
    background: linear-gradient(90deg, #222 0%, #cf4f28 50%, #222 100%);
    background-size: 200% 100%;
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    animation: gradientMove 8s linear infinite;
  }

  @keyframes gradientMove {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  .panel-tabs {
    display: flex;
    justify-content: flex-start;
    gap: 1.5em;
    flex-wrap: wrap;
    margin-bottom: 1.5em;
  }

  .tab-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.8em 1.2em;
    border-radius: 12px;
    background-color: #fff;
    border: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    min-width: 100px;
  }

  .tab-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
    border-color: rgba(207, 79, 40, 0.2);
  }

  .tab-item.active {
    background: linear-gradient(135deg, rgba(207, 79, 40, 0.1) 0%, rgba(207, 79, 40, 0.05) 100%);
    border-color: rgba(207, 79, 40, 0.3);
    transform: translateY(-3px);
    box-shadow: 0 8px 16px rgba(207, 79, 40, 0.15);
  }

  .tab-item.active::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(207, 79, 40, 0.05) 0%, rgba(207, 79, 40, 0.02) 100%);
    z-index: 0;
  }

  .tab-icon {
    font-size: 1.8rem;
    margin-bottom: 0.4em;
    position: relative;
    z-index: 1;
  }

  .tab-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: #444;
    position: relative;
    z-index: 1;
  }

  .tab-count {
    font-size: 0.75rem;
    color: #888;
    margin-top: 0.2em;
    position: relative;
    z-index: 1;
  }

  .card-content-container {
    position: relative;
    min-height: 0;
    overflow: hidden;
    transition: min-height 0.3s ease;
  }

  .card-content-container.has-active {
    min-height: 200px;
  }

  .content-card {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    pointer-events: none;
  }

  .content-card.active {
    position: relative;
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
    pointer-events: auto;
  }



  .card-body {
    padding: 0;
  }



  .verified-links {
    margin-bottom: 1.5em;
  }
  
  .card-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 1.5em;
    margin: 0 auto;
    max-width: 900px;
  }
  
  .card-wrap {
    display: flex;
    flex-direction: column;
  }
  
  .modern-card {
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: #222;
    transition: all 0.3s ease;
    height: 100%;
  }
  
  .modern-card-border {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    padding: 1em;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: all 0.3s ease;
    position: relative;
  }
  
  .modern-card:hover .modern-card-border {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 8px 24px rgba(207, 79, 40, 0.2);
    border-color: rgba(207, 79, 40, 0.3);
  }
  
  .modern-card:hover .card-tooltip {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(-15px);
  }
  
  .card-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: #222;
    margin-top: 0.8em;
    margin-bottom: 0;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
  }
  
  .card-tooltip {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-10px);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 0.6em 0.8em;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    white-space: normal;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10;
    max-width: 250px;
    width: max-content;
    min-width: 200px;
    word-wrap: break-word;
  }
  
  .card-tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: rgba(0, 0, 0, 0.8);
  }
  
  .tooltip-content {
    display: flex;
    flex-direction: column;
  }
  
  .tooltip-desc {
    font-size: 0.85rem;
    max-width: 100%;
    word-wrap: break-word;
    line-height: 1.4;
  }
  
  .modern-card.inactive .modern-card-border {
    opacity: 0.6;
  }
  
  .modern-card:hover .card-title {
    color: #cf4f28;
  }
  
  .modern-card.highlight .modern-card-border {
    border-color: #cf4f28;
    box-shadow: 0 0 0 1px rgba(207, 79, 40, 0.3), 0 8px 24px rgba(207, 79, 40, 0.4);
  }
  
  .modern-card.highlight .card-title {
    color: #cf4f28;
    font-weight: 600;
  }
  
  .modern-card.highlight .card-tooltip {
    opacity: 0;
    visibility: hidden;
  }
  
  .modern-card.selected .modern-card-border {
    border-color: #cf4f28;
    box-shadow: 0 0 0 3px rgba(207, 79, 40, 0.4), 0 10px 30px rgba(207, 79, 40, 0.5);
  }
  
  .modern-card.selected .card-title {
    color: #cf4f28;
    font-weight: 700;
  }
  
  .modern-card.selected .card-tooltip {
    opacity: 0;
    visibility: hidden;
  }
  
  .friend-avatar {
    position: relative;
    width: 52px;
    height: 52px;
    margin-bottom: 0.5em;
  }
  
  .friend-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #f0f0f0;
    transition: border-color 0.15s ease;
  }
  
  .modern-card:hover .friend-avatar img {
    border-color: #cf4f28;
  }
  
  .verified-badge {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 8px;
    height: 8px;
    background-color: #28a745;
    border-radius: 50%;
    border: 2px solid #fff;
  }

  /* æœªéªŒè¯é“¾æ¥çš„æ ·å¼ */
  .unverified-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.8em;
    max-width: 900px;
    margin: 0 auto;
  }
  
  .friend-text-item {
    display: inline-block;
    text-decoration: none;
    color: #555;
    background-color: #f8f8f8;
    border: 1px solid #e5e5e5;
    border-radius: 20px;
    padding: 0.4em 1em;
    font-size: 0.85rem;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    animation: fadeIn 0.5s ease-out forwards;
    opacity: 0;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .friend-text-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
  }
  
  .friend-text-item:hover::before {
    left: 100%;
  }
  
  .friend-text-item:hover {
    background-color: #f0f0f0;
    border-color: #cf4f28;
    color: #444;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  }
  
  .friend-text-item:active {
    transform: translateY(0);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  
  .friend-text-item.inactive {
    opacity: 0.6;
  }
  
  .friend-text-name {
    white-space: nowrap;
  }

  /* åšå®¢ç»„ç»‡æ ·å¼ */
  .organization-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 1.5em;
    margin: 0 auto;
    max-width: 900px;
  }
  
  .organization-item {
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: #222;
    transition: all 0.3s ease;
    height: 100%;
  }
  
  .organization-item:hover {
    transform: translateY(-2px);
  }
  
  .organization-item:hover .org-card {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 8px 24px rgba(207, 79, 40, 0.2);
    border-color: rgba(207, 79, 40, 0.3);
  }
  
  .org-card {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    padding: 1em;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: all 0.3s ease;
    position: relative;
  }
  
  .org-logo {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 0.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f5f5f5;
    position: relative;
  }
  
  .org-logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border: 2px solid #f0f0f0;
    transition: border-color 0.15s ease;
  }
  
  .organization-item:hover .org-logo img {
    border-color: #cf4f28;
  }
  
  .org-placeholder {
    font-size: 1.5rem;
    line-height: 1;
  }
  
  .org-info {
    width: 100%;
    text-align: center;
  }
  
  .org-name {
    font-size: 0.9rem;
    font-weight: 600;
    color: #222;
    margin-top: 0.8em;
    margin-bottom: 0;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
  }
  
  .org-desc {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-10px);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 0.6em 0.8em;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    white-space: normal;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10;
    max-width: 250px;
    width: max-content;
    min-width: 200px;
    word-wrap: break-word;
  }
  
  .org-desc::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: rgba(0, 0, 0, 0.8);
  }
  
  .organization-item:hover .org-desc {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(-15px);
  }
  
  /* å‹é“¾ç”³è¯·éƒ¨åˆ†æ ·å¼ */
  .apply-card {
    background: #ffffff;
    border: 1px solid rgba(207, 79, 40, 0.15);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 0 0 rgba(207, 79, 40, 0),
                0 8px 32px rgba(207, 79, 40, 0.06);
    transition: all 0.5s ease;
    position: relative;
    z-index: 1;
    max-width: 700px;
    margin: 0 auto;
  }
  
  .apply-card::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 18px;
    border: 1px solid rgba(207, 79, 40, 0.2);
    box-shadow: 0 0 15px rgba(207, 79, 40, 0.2);
    pointer-events: none;
    z-index: -1;
    animation: breathe 3s infinite alternate ease-in-out;
  }
  
  .card-top {
    display: flex;
    align-items: center;
    padding: 0.8em 1em;
    border-bottom: 1px solid #f0f0f0;
  }
  
  .site-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 0.7em;
    flex-shrink: 0;
    border: 2px solid #f8f8f8;
  }
  
  .site-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .site-info {
    flex: 1;
  }
  
  .site-name {
    font-size: 1.05rem;
    font-weight: 600;
    color: #222;
    margin: 0 0 0.2em 0;
  }
  
  .site-desc {
    font-size: 0.8rem;
    color: #666;
    margin: 0;
    line-height: 1.3;
  }
  
  .site-details {
    padding: 0.2em 1em 0.8em;
  }
  
  .detail-row {
    display: flex;
    align-items: center;
    padding: 0.4em 0;
    border-bottom: 1px solid #f5f5f5;
  }
  
  .detail-row:last-child {
    border-bottom: none;
  }
  
  .detail-key {
    width: 70px;
    font-size: 0.8rem;
    font-weight: 500;
    color: #333;
    flex-shrink: 0;
  }
  
  .detail-value {
    flex: 1;
    font-family: 'Courier New', monospace;
    font-size: 0.75rem;
    color: #555;
    background-color: #f8f8f8;
    padding: 0.3em 0.5em;
    border-radius: 3px;
    word-break: break-all;
    margin-right: 0.6em;
  }
  
  .copy-btn {
    background: transparent;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 0.15em 0.5em;
    font-size: 0.65rem;
    color: #666;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
  }
  
  .copy-btn:hover {
    border-color: #cf4f28;
    color: #cf4f28;
    background-color: rgba(207, 79, 40, 0.05);
  }
  
  @keyframes breathe {
    0% {
      opacity: 0.3;
      box-shadow: 0 0 8px rgba(207, 79, 40, 0.15);
    }
    50% {
      opacity: 0.7;
      box-shadow: 0 0 25px rgba(207, 79, 40, 0.3);
    }
    100% {
      opacity: 0.3;
      box-shadow: 0 0 8px rgba(207, 79, 40, 0.15);
    }
  }

  @media (max-width: 640px) {
    .card-switch-container {
      padding: 1.5em;
      margin-bottom: 2em;
    }

    .panel-header {
      margin-bottom: 1.5em;
    }

    .panel-title {
      font-size: 1.1rem;
    }

    .panel-tabs {
      justify-content: center;
      gap: 1em;
      margin-bottom: 1.2em;
    }

    .tab-item {
      padding: 0.6em 0.8em;
      min-width: 80px;
    }

    .tab-icon {
      font-size: 1.5rem;
    }

    .tab-label {
      font-size: 0.8rem;
    }

    .tab-count {
      font-size: 0.7rem;
    }

    .card-container {
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 1em;
    }
    
    .modern-card-border {
      padding: 0.8em;
    }
    
    .friend-avatar {
      width: 44px;
      height: 44px;
    }
    
    .card-title {
      font-size: 0.8rem;
    }
    
    .card-tooltip {
      max-width: 200px;
      min-width: 160px;
      padding: 0.5em 0.6em;
    }
    
    .tooltip-desc {
      font-size: 0.8rem;
      line-height: 1.3;
    }
    
    .unverified-container {
      gap: 0.6em;
    }
    
    .friend-text-item {
      font-size: 0.8rem;
      padding: 0.3em 0.8em;
    }
    
    .organization-container {
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 1em;
    }
    
    .org-card {
      padding: 0.8em;
    }
    
    .org-logo {
      width: 44px;
      height: 44px;
    }
    
    .org-name {
      font-size: 0.8rem;
    }
    
    .org-desc {
      max-width: 200px;
      min-width: 160px;
      padding: 0.5em 0.6em;
      font-size: 0.8rem;
      line-height: 1.3;
    }
    
    .copy-btn {
      font-size: 0.6rem;
      padding: 0.1em 0.4em;
    }
  }
</style>

    <script>
  // éšæœºSloganåŠŸèƒ½
  function initRandomSlogan() {
    const sloganElement = document.getElementById('random-slogan');
    if (sloganElement) {
      const slogansData = sloganElement.getAttribute('data-slogans');
      if (slogansData) {
        const slogans = slogansData.split('|');
        // ä½¿ç”¨å½“å‰æ—¶é—´ä½œä¸ºéšæœºç§å­ï¼Œå¢å¼ºéšæœºæ€§
        const randomIndex = Math.floor(Math.random() * slogans.length);
        sloganElement.textContent = slogans[randomIndex];
      }
    }
  }

  // å…¬å…±å‡½æ•°åˆå§‹åŒ–å¡ç‰‡åˆ‡æ¢åŠŸèƒ½
  function initCardSwitcher() {
    const tabItems = document.querySelectorAll('.tab-item');
    const contentCards = document.querySelectorAll('.content-card');
    const contentContainer = document.querySelector('.card-content-container');
    
    // é»˜è®¤éšè—æ‰€æœ‰å†…å®¹å¡ç‰‡
    contentCards.forEach(card => {
      card.classList.remove('active');
    });
    
    // åˆå§‹åŒ–å®¹å™¨çŠ¶æ€
    contentContainer.classList.remove('has-active');
    
    // å¡ç‰‡åˆ‡æ¢å‡½æ•° - åˆ‡æ¢æ˜¾ç¤º/éšè—çŠ¶æ€
    function toggleCard(targetTab) {
      const targetId = targetTab.getAttribute('data-target');
      const isActive = targetTab.classList.contains('active');
      
      if (isActive) {
        // å¦‚æœå½“å‰å¡ç‰‡å·²æ¿€æ´»ï¼Œåˆ™éšè—å®ƒ
        targetTab.classList.remove('active');
        const targetCard = document.getElementById(targetId);
        if (targetCard) {
          targetCard.classList.remove('active');
        }
        
        // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å…¶ä»–æ¿€æ´»çš„å¡ç‰‡
        const hasActiveCard = Array.from(tabItems).some(item => item.classList.contains('active'));
        if (!hasActiveCard) {
          contentContainer.classList.remove('has-active');
        }
      } else {
        // å¦‚æœå½“å‰å¡ç‰‡æœªæ¿€æ´»ï¼Œåˆ™æ˜¾ç¤ºå®ƒï¼Œå¹¶éšè—å…¶ä»–å¡ç‰‡
        tabItems.forEach(item => {
          item.classList.remove('active');
        });
        
        contentCards.forEach(card => {
          card.classList.remove('active');
        });
        
        targetTab.classList.add('active');
        const targetCard = document.getElementById(targetId);
        if (targetCard) {
          targetCard.classList.add('active');
        }
        
        contentContainer.classList.add('has-active');
      }
    }
    
    // ä¸ºæ¯ä¸ªé€‰é¡¹å¡æ·»åŠ ç‚¹å‡»äº‹ä»¶
    tabItems.forEach(tab => {
      tab.addEventListener('click', () => {
        toggleCard(tab);
      });
    });
  }

  // å…¬å…±å‡½æ•°åˆå§‹åŒ–å¤åˆ¶æŒ‰é’®åŠŸèƒ½
  function initCopyButtons() {
    const copyButtons = document.querySelectorAll('.copy-btn');
    
    copyButtons.forEach(button => {
      button.addEventListener('click', async () => {
        const textToCopy = button.getAttribute('data-copy');
        
        if (textToCopy) {
          try {
            await navigator.clipboard.writeText(textToCopy);
            
            // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçŠ¶æ€
            const originalText = button.textContent;
            button.textContent = 'å·²å¤åˆ¶';
            button.style.backgroundColor = 'rgba(207, 79, 40, 0.1)';
            button.style.borderColor = '#cf4f28';
            button.style.color = '#cf4f28';
            
            // 1ç§’åæ¢å¤åŸçŠ¶æ€
            setTimeout(() => {
              button.textContent = originalText;
              button.style.backgroundColor = '';
              button.style.borderColor = '';
              button.style.color = '';
            }, 1000);
          } catch (err) {
            console.error('å¤åˆ¶å¤±è´¥:', err);
            
            button.textContent = 'å¤åˆ¶å¤±è´¥';
            
            setTimeout(() => {
              button.textContent = 'å¤åˆ¶';
            }, 2000);
          }
        }
      });
    });
  }

  // å…¬å…±å‡½æ•°åˆå§‹åŒ–éšæœºè®¿é—®åŠŸèƒ½
  function initRandomButton() {
    const randomButton = document.getElementById('random-visit-button');
    
    if (randomButton && !randomButton.hasAttribute('data-initialized')) {
      randomButton.setAttribute('data-initialized', 'true');
      
      randomButton.addEventListener('click', function(e) {
        const items = document.querySelectorAll('.modern-card');
        const validLinks = Array.from(items).filter(item => !item.classList.contains('inactive'));
        
        if (validLinks.length === 0 || items.length === 0) return;
        
        // ç¦ç”¨æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
        this.disabled = true;
        this.querySelector('.action-label').textContent = 'é€‰æ‹©ä¸­...';
        
        // éšæœºé€‰æ‹©ä¸€ä¸ªç´¢å¼•
        const randomIndex = Math.floor(Math.random() * validLinks.length);
        
        // è·‘é©¬ç¯æ•ˆæœ
        let currentIndex = 0;
        let round = 0;
        const totalRounds = 2;
        let speed = 30;
        
        const runMarathon = () => {
          // ç§»é™¤æ‰€æœ‰é«˜äº®
          validLinks.forEach(item => {
            item.classList.remove('highlight', 'selected');
          });
          
          // æ·»åŠ å½“å‰é«˜äº®
          validLinks[currentIndex].classList.add('highlight');
          
          // å¢åŠ ç´¢å¼•
          currentIndex = (currentIndex + 1) % validLinks.length;
          
          // å¦‚æœå®Œæˆä¸€åœˆ
          if (currentIndex === 0) {
            round++;
            speed += 40;
          }
          
          // å¦‚æœè·‘å®Œé¢„è®¾çš„åœˆæ•°ï¼Œè¿›å…¥æœ€ç»ˆé€‰æ‹©é˜¶æ®µ
          if (round >= totalRounds) {
            // åœåœ¨éšæœºé€‰æ‹©çš„é¡¹ç›®ä¸Š
            validLinks[randomIndex].classList.remove('highlight');
            validLinks[randomIndex].classList.add('selected');
            
            // ç›´æ¥æ‰“å¼€é“¾æ¥
            const linkElement = validLinks[randomIndex];
            const href = linkElement.href;
            
            if (href) {
              window.open(href, '_blank', 'noopener,noreferrer');
            }
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(() => {
              this.disabled = false;
              this.querySelector('.action-label').textContent = 'éšæœºè®¿é—®';
              validLinks.forEach(item => {
                item.classList.remove('highlight', 'selected');
              });
            }, 2000);
            
            return;
          }
          
          // ç»§ç»­ä¸‹ä¸€å¸§
          setTimeout(runMarathon, speed);
        };
        
        // å¼€å§‹è·‘é©¬ç¯
        runMarathon();
      });
    }
  }

  // åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
  function initializeAllFunctions() {
    initRandomSlogan();
    initCardSwitcher();
    initCopyButtons();
    initRandomButton();
  }

  // ç«‹å³æ£€æŸ¥DOMæ˜¯å¦å·²ç»åŠ è½½å®Œæˆ
  if (document.readyState === 'loading') {
    // å¦‚æœDOMè¿˜åœ¨åŠ è½½ä¸­ï¼Œç­‰å¾…DOMContentLoadedäº‹ä»¶
    document.addEventListener('DOMContentLoaded', initializeAllFunctions);
  } else {
    // å¦‚æœDOMå·²ç»åŠ è½½å®Œæˆï¼Œç«‹å³åˆå§‹åŒ–
    initializeAllFunctions();
  }
  
  // Astroé¡µé¢åˆ‡æ¢åé‡æ–°ç»‘å®šäº‹ä»¶
  document.addEventListener('astro:after-swap', () => {
    // ç­‰å¾…DOMæ›´æ–°å®Œæˆ
    setTimeout(initializeAllFunctions, 100);
  });
</script>