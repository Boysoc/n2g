import"./hoisted.lrI1EPAS.js";let r=null;function l(){if(r){try{r.destroy()}catch(e){console.log("清理旧实例:",e.message)}r=null}const n=document.getElementById("waline-comments");if(!n){console.log("评论容器不存在，等待DOM更新");return}if(typeof window.Waline>"u"){const e=document.createElement("script");e.src="https://unpkg.com/@waline/client@v3/dist/waline.umd.js",e.onload=function(){s()},e.onerror=function(){console.error("Waline 加载失败"),n.innerHTML='<p style="text-align: center; color: #999;">评论系统加载失败，请刷新页面重试</p>'},document.head.appendChild(e)}else s()}function s(){const n=document.getElementById("waline-comments");if(n){n.innerHTML="";try{r=window.Waline.init({el:"#waline-comments",serverURL:"https://tencent.n2g.cn/",path:window.location.pathname.endsWith("/")?window.location.pathname:window.location.pathname+"/",lang:"zh-CN",avatar:"qq",locale:{placeholder:"期待你的真知灼见~",sofa:"快来做第一个评论的人吧~",submit:"提交",reply:"回复",cancelReply:"取消回复",comment:"评论",refresh:"刷新",more:"加载更多...",preview:"预览",emoji:"表情",uploadImage:"上传图片"},formatTime:function(e){const o=new Date(e),c=o.getFullYear(),t=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0"),m=String(o.getHours()).padStart(2,"0"),u=String(o.getMinutes()).padStart(2,"0"),p=String(o.getSeconds()).padStart(2,"0");return`${c}年${t}月${a}日 ${m}:${u}:${p}`},emoji:["https://unpkg.com/@waline/emojis@1.2.0/qq"],dark:"auto",meta:["nick","mail","link"],requiredMeta:["nick"],pageSize:10,wordLimit:[0,1e3],imageUploader:!1,highlight:!0,mathTagSupport:!1,commentSorting:"latest",search:!1,reaction:!1,copyright:!1,login:"disable"}),console.log("Waline 评论系统初始化成功，路径:",window.location.pathname)}catch(e){console.error("Waline 初始化失败:",e),n.innerHTML='<p style="text-align: center; color: #999;">评论系统初始化失败</p>'}}}function i(){console.log("检测到页面导航，重新初始化评论系统"),setTimeout(()=>{l()},300)}function d(){let n=window.location.href;setInterval(()=>{const t=window.location.href;t!==n&&(n=t,i())},200);const o=history.pushState,c=history.replaceState;history.pushState=function(...t){o.apply(this,t),i()},history.replaceState=function(...t){c.apply(this,t),i()},window.addEventListener("popstate",i),document.addEventListener("click",function(t){const a=t.target.closest("a");a&&a.href&&a.href.startsWith(window.location.origin)&&setTimeout(i,500)},!0)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){setTimeout(l,100),d()}):(setTimeout(l,100),d());
